<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AI Chat Node Viewer - NodeSpace Design System</title>
  <meta name="description" content="Full-page AI Chat Node Viewer with message history, input, and send functionality.">
  <link rel="stylesheet" href="assets/shadcn-variables.css">
  <link rel="stylesheet" href="assets/style-guide.css">
  <link rel="stylesheet" href="assets/design-system-icons.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ§ </text></svg>">

  <!-- Prevent flash of unstyled content by applying theme immediately -->
  <script>
    (function() {
      const savedTheme = localStorage.getItem('nodespace-style-guide-theme') || 'system';
      const resolvedTheme = savedTheme === 'system'
        ? (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
        : savedTheme;

      if (resolvedTheme === 'dark') {
        document.documentElement.className = 'dark';
      }
    })();
  </script>

  <style>
    /* Chat Component Styles */

    .chat-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .chat-bubble {
      display: flex;
      gap: 0.75rem;
      align-items: flex-start;
    }

    .chat-bubble.user {
      flex-direction: row-reverse;
    }

    .chat-bubble-avatar {
      flex-shrink: 0;
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chat-bubble-content {
      flex: 1;
      max-width: 70%;
    }

    .chat-bubble.user .chat-bubble-content {
      margin-left: auto;
    }

    .chat-bubble-message {
      background: hsl(var(--muted));
      padding: 0.75rem 1rem;
      border-radius: var(--radius);
      font-size: 0.875rem;
      line-height: 1.6;
      color: hsl(var(--foreground));
      position: relative;
    }

    .chat-bubble.user .chat-bubble-message {
      background: hsl(200 12% 90%);
      color: hsl(var(--foreground));
    }

    .chat-bubble.ai .chat-bubble-message {
      background: hsl(var(--muted));
    }

    /* Better contrast in dark mode - user prompts significantly lighter than AI responses */
    .dark .chat-bubble.user .chat-bubble-message {
      background: hsl(200 12% 22%);
    }

    /* Copy button for AI messages */
    .message-copy-button {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      color: hsl(var(--foreground));
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .chat-bubble-message:hover .message-copy-button {
      opacity: 1;
    }

    .message-copy-button:hover {
      background: hsl(var(--muted));
      border-color: hsl(var(--primary));
    }

    /* Node icon integration */
    .chat-node-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      padding-bottom: 0.75rem;
      border-bottom: 1px solid hsl(var(--border));
    }

    .chat-node-header .ns-icon {
      position: static;
    }

    .chat-node-title {
      font-weight: 600;
      font-size: 0.875rem;
      color: hsl(var(--foreground));
    }

    /* Typing indicator */
    .typing-indicator {
      display: inline-flex;
      gap: 0.25rem;
      align-items: center;
      padding: 0.5rem;
    }

    .typing-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: hsl(var(--muted-foreground));
      animation: typing-bounce 1.4s infinite;
    }

    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }

    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }

    @keyframes typing-bounce {
      0%, 60%, 100% {
        transform: translateY(0);
      }
      30% {
        transform: translateY(-6px);
      }
    }

    /* User avatar - 3/4 circle with squared bottom-left corner, using secondary color */
    .user-avatar {
      width: 20px;
      height: 20px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      color: hsl(var(--background));
      font-size: 0.625rem;
      font-weight: 600;
      text-transform: lowercase;
    }

    /* 3/4 circle background with squared bottom-left corner - using secondary color to differentiate */
    .user-avatar::before {
      content: "";
      position: absolute;
      width: 20px;
      height: 20px;
      top: 0;
      left: 0;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20'%3E%3Cpath d='M10 0 C4.477 0 0 4.477 0 10 L0 19.375 C0 19.72 0.28 20 0.625 20 L10 20 C15.523 20 20 15.523 20 10 C20 4.477 15.523 0 10 0 Z' fill='hsl(200 12%25 60%25)'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: center;
      background-size: 20px 20px;
      z-index: 0;
    }

    /* Text content positioned above background - adjusted for better vertical centering */
    .user-avatar::after {
      content: "me";
      position: relative;
      z-index: 1;
      margin-top: -1px;
    }

    /* AI avatar - uses standard ns-icon (20x20px) */
    .ai-avatar {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Scale AI icon in chat bubbles to fill 20x20 container */
    .ai-avatar .ai-square {
      width: 20px;
      height: 20px;
      top: 0;
      left: 0;
      background-size: 20px 20px;
    }

    .ai-avatar .ai-square::after {
      width: 15px;
      height: 15px;
      background-size: 15px 15px;
    }

    /* Fix header icon sparkle - properly scaled and with punch-hole effect */
    .ns-icon--lg .ai-square::after {
      width: 18px;
      height: 18px;
      background-size: 18px 18px;
      background-image: url("data:image/svg+xml,%3Csvg width='18' height='18' viewBox='0 0 18 18' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9 0 L11.25 6.75 L18 9 L11.25 11.25 L9 18 L6.75 11.25 L0 9 L6.75 6.75 Z' fill='hsl(0 0%25 99%25)'/%3E%3C/svg%3E");
    }

    /* Dark theme - punch-hole effect for sparkle */
    .dark .ns-icon--lg .ai-square::after {
      background-image: url("data:image/svg+xml,%3Csvg width='18' height='18' viewBox='0 0 18 18' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M9 0 L11.25 6.75 L18 9 L11.25 11.25 L9 18 L6.75 11.25 L0 9 L6.75 6.75 Z' fill='hsl(0 0%25 12%25)'/%3E%3C/svg%3E");
    }

    /* AI Chat Node hover behavior */
    .ai-chat-node-example:hover .chat-open-button {
      opacity: 1 !important;
    }

    .chat-open-button:hover {
      background: hsl(var(--muted)) !important;
      border-color: hsl(var(--primary)) !important;
    }

    /* Chat Input Area */
    .chat-input-container {
      flex-shrink: 0;
      padding: 1rem;
      border-top: 1px solid hsl(var(--border));
      background: hsl(var(--background));
      border-bottom-left-radius: var(--radius);
      border-bottom-right-radius: var(--radius);
    }

    .chat-input-wrapper {
      display: flex;
      align-items: flex-end;
      gap: 0.5rem;
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
      padding: 0.5rem;
      transition: border-color 0.15s ease;
    }

    .chat-input-wrapper:focus-within {
      border-color: hsl(var(--primary));
    }

    .chat-input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      color: hsl(var(--foreground));
      font-size: 0.875rem;
      font-family: inherit;
      resize: none;
      min-height: 24px;
      max-height: 120px;
      line-height: 1.5;
      padding: 0.25rem 0;
    }

    .chat-input::placeholder {
      color: hsl(var(--muted-foreground));
    }

    .chat-send-button {
      flex-shrink: 0;
      width: 32px;
      height: 32px;
      border-radius: 0.25rem;
      background: hsl(var(--node-text));
      color: hsl(var(--primary-foreground));
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chat-send-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Dark mode user avatar - using lighter secondary color to differentiate from AI */
    .dark .user-avatar::before {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 20 20'%3E%3Cpath d='M10 0 C4.477 0 0 4.477 0 10 L0 19.375 C0 19.72 0.28 20 0.625 20 L10 20 C15.523 20 20 15.523 20 10 C20 4.477 15.523 0 10 0 Z' fill='hsl(200 12%25 65%25)'/%3E%3C/svg%3E");
    }
  </style>
</head>
<body class="no-transitions">
  <div class="style-guide">
    <!-- Header -->
    <header>
      <h1>AI Chat Node Viewer</h1>
      <p>Full-page viewer for AI Chat Nodes with message history, input area, and send functionality.</p>
    </header>

    <!-- Navigation -->
    <nav class="style-guide-nav">
      <!-- Navigation links generated by JavaScript -->
      <div class="theme-toggle">
        <!-- Theme toggle buttons will be generated by JavaScript -->
      </div>
    </nav>

    <main>
      <!-- AI Chat Node Viewer -->
      <section class="example-section">
        <h2>AI Chat Node Viewer</h2>
        <p>Full-page detailed view of AI chat conversations with message history. Opens when user clicks "open" button on AI Chat Node.</p>
        <div style="border: 1px solid hsl(var(--border)); border-radius: var(--radius); padding: 0; background: hsl(var(--background)); margin-bottom: 2rem; display: flex; flex-direction: column; height: 600px;">
          <!-- Viewer Header (fixed, doesn't scroll) - inherits BaseNodeViewer styling -->
          <div style="flex-shrink: 0; padding: 1rem; border-bottom: 1px solid hsl(var(--border)); background: hsl(var(--background)); border-top-left-radius: var(--radius); border-top-right-radius: var(--radius);">
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <div class="ns-icon ns-icon--lg" role="img" aria-label="AI chat icon">
                <div class="ai-square"></div>
              </div>
              <h1 style="font-size: 2rem; font-weight: 500; color: hsl(var(--muted-foreground)); margin: 0;">Untitled AI Chat</h1>
            </div>
          </div>

          <!-- Scrollable Chat Content Area -->
          <div style="flex: 1; overflow-y: auto; padding: 1.5rem;">
            <div class="chat-list">
              <!-- User Message -->
              <div class="chat-bubble user">
                <div class="chat-bubble-avatar">
                  <div class="user-avatar"></div>
                </div>
                <div class="chat-bubble-content">
                  <div class="chat-bubble-message">
                    What are the key principles of good UX design?
                  </div>
                </div>
              </div>

              <!-- AI Response -->
              <div class="chat-bubble ai">
                <div class="chat-bubble-avatar">
                  <div class="ai-avatar">
                    <div class="ns-icon" role="img" aria-label="AI icon">
                      <div class="ai-square"></div>
                    </div>
                  </div>
                </div>
                <div class="chat-bubble-content">
                  <div class="chat-bubble-message">
                    Good UX design follows several core principles:

                    1. <strong>User-centered</strong>: Design should prioritize user needs and goals
                    2. <strong>Consistency</strong>: Maintain consistent patterns and interactions
                    3. <strong>Clarity</strong>: Make interfaces intuitive and easy to understand
                    4. <strong>Feedback</strong>: Provide clear responses to user actions
                    5. <strong>Accessibility</strong>: Ensure everyone can use the product

                    These principles help create experiences that are both functional and delightful.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Chat Input Area (fixed at bottom) -->
          <div class="chat-input-container">
            <div class="chat-input-wrapper">
              <textarea
                class="chat-input"
                placeholder="Ask a question..."
                rows="1"
              ></textarea>
              <button class="chat-send-button" aria-label="Send message">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M2 2L14 8L2 14L4 8L2 2Z" fill="hsl(var(--content-background))"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <div style="margin-top: 1rem; padding: 1rem; background: hsl(var(--muted)); border-radius: var(--radius); font-size: 0.875rem;">
          <strong>Design System Features:</strong>
          <ul style="margin: 0.5rem 0 0 0; padding-left: 1.5rem; line-height: 1.8;">
            <li><strong>Visual Hierarchy:</strong> Prominent 2rem header (muted-foreground) with 24px AI icon for brand consistency, fixed header with bottom border establishes clear content separation</li>
            <li><strong>Message Differentiation:</strong> User prompts use lighter background (90% light / 22% dark) contrasting with content area (99% light / 12% dark), AI responses use subtle muted background (94% light / 16% dark) for visual rhythm</li>
            <li><strong>Avatar System:</strong> 20px avatars maintain consistent sizingâ€”AI icon uses chat bubble shape with primary color, user avatar employs 3/4 circle (squared bottom-left) with secondary color (60% light / 65% dark) for visual distinction</li>
            <li><strong>Input Area:</strong> Fixed bottom positioning with auto-expanding textarea, send button uses primary color with punch-hole arrow icon matching background color for theme consistency</li>
            <li><strong>Spatial Design:</strong> Scrollable chat area with fixed header and input creates immersive focus, generous padding and border-radius maintain design system consistency</li>
          </ul>
        </div>
      </section>

    </main>

    <!-- Footer -->
    <footer>
      <p>&copy; 2024 NodeSpace. Part of the NodeSpace Design System</p>
    </footer>
  </div>

  <!-- JavaScript -->
  <script src="assets/interactive.js"></script>

  <script>
    // Copy button functionality
    document.querySelectorAll('.message-copy-button').forEach(button => {
      button.addEventListener('click', (e) => {
        e.stopPropagation();
        const messageText = button.parentElement.textContent.replace('Copy', '').trim();
        navigator.clipboard.writeText(messageText).then(() => {
          const originalText = button.textContent;
          button.textContent = 'Copied!';
          setTimeout(() => {
            button.textContent = originalText;
          }, 2000);
        });
      });
    });
  </script>
</body>
</html>
