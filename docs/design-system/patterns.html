<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Patterns - NodeSpace Design System</title>
  <meta name="description" content="Layout patterns, interaction behaviors, and responsive design guidelines for NodeSpace.">
  <link rel="stylesheet" href="assets/shadcn-variables.css">
  <link rel="stylesheet" href="assets/style-guide.css">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🧠</text></svg>">
  
  <!-- Prevent flash of unstyled content by applying theme immediately -->
  <script>
    (function() {
      // Apply theme before page renders to prevent flash
      const savedTheme = localStorage.getItem('nodespace-style-guide-theme') || 'system';
      const resolvedTheme = savedTheme === 'system' 
        ? (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
        : savedTheme;
      
      if (resolvedTheme === 'dark') {
        document.documentElement.className = 'dark';
      }
    })();
  </script>
  <style>
    /* Apply Warm Gray color scheme to entire document */
    :root {
      /* Color system - Warm Gray theme (light mode) */
      --primary: 25 25% 55%;             /* Warm gray primary */
      --primary-foreground: 0 0% 98%;    /* Off-white for primary text */
      
      --secondary: 25 15% 94%;           /* Light warm gray secondary */
      --secondary-foreground: 25 15% 45%; /* Medium warm gray for secondary text */
      
      --accent: 25 25% 55%;              /* Same as primary for consistency */
      --accent-foreground: 0 0% 98%;     /* Off-white for accent text */
      
      --background: 0 0% 98%;            /* Clean off-white background */
      --foreground: 25 25% 15%;          /* Dark warm gray text */
      
      --card: 0 0% 100%;                 /* Pure white cards */
      --card-foreground: 25 25% 15%;     /* Dark warm gray text */
      
      --popover: 0 0% 100%;              /* Same as cards */
      --popover-foreground: 25 25% 15%;
      
      --muted: 25 15% 94%;               /* Light warm gray muted areas */
      --muted-foreground: 25 15% 45%;    /* Medium warm gray for muted text */
      
      /* Systematic hover states - WCAG-compliant contrast */
      --hover-background: var(--muted);
      --hover-foreground: var(--muted-foreground);
      
      --border: 25 15% 88%;              /* Light warm gray borders */
      --input: 25 15% 88%;
      --ring: 25 25% 55%;                /* Focus ring matches primary */
      
      --destructive: 0 84% 60%;
      --destructive-foreground: 0 0% 100%;
      
      --success: 142 76% 36%;            /* #22c55e - Green for completed items */
      --success-foreground: 0 0% 100%;
      
      --warning: 45 93% 47%;             /* #eab308 - Yellow/orange for in-progress */
      --warning-foreground: 0 0% 100%;
      
      --radius: 0.5rem;
    }

    .dark {
      /* Color system - Warm Gray theme (dark mode) */
      --primary: 25 25% 65%;             /* Lighter warm gray primary for dark theme */
      --primary-foreground: 0 0% 95%;    /* Very light gray for primary text */
      
      --secondary: 25 15% 12%;           /* Very dark warm gray secondary */
      --secondary-foreground: 25 15% 60%; /* Light warm gray for secondary text */
      
      --accent: 25 25% 65%;              /* Same as primary for consistency */
      --accent-foreground: 0 0% 95%;     /* Very light gray for accent text */
      
      --background: 0 0% 8%;             /* Very dark background */
      --foreground: 25 25% 90%;          /* Light warm gray text */
      
      --card: 25 15% 10%;                /* Slightly elevated dark cards */
      --card-foreground: 25 25% 90%;     /* Light warm gray text */
      
      --popover: 25 15% 10%;             /* Same as cards */
      --popover-foreground: 25 25% 90%;
      
      --muted: 25 15% 12%;               /* Dark warm gray muted areas */
      --muted-foreground: 25 15% 60%;    /* Light warm gray for muted text */
      
      /* Systematic hover states - WCAG-compliant contrast */
      --hover-background: var(--muted);
      --hover-foreground: var(--muted-foreground);
      
      --border: 25 15% 20%;              /* Dark warm gray borders */
      --input: 25 15% 22%;               /* Slightly lighter for inputs */
      --ring: 25 25% 65%;                /* Focus ring matches primary */
      
      --destructive: 0 84% 60%;
      --destructive-foreground: 0 0% 100%;
      
      --success: 142 76% 36%;            /* #22c55e - Same green */
      --success-foreground: 0 0% 100%;
      
      --warning: 45 93% 47%;             /* #eab308 - Same yellow/orange */
      --warning-foreground: 0 0% 100%;
    }
    
    /* Content demo container - same structure as shell-demo */
    .content-demo-container {
      display: flex;
      height: 400px;
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
      overflow: hidden;
      margin: 1rem 0;
    }
    
    /* Blinking cursor animation for demo */
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
    
    /* Date Navigation Button - Systematic Hover States */
    .date-nav-button {
      width: 32px;
      height: 32px;
      border: 1px solid hsl(var(--border));
      border-radius: 0.375rem;
      background: hsl(var(--background));
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s ease;
      color: hsl(var(--foreground));
    }
    
    .date-nav-button:hover {
      background: hsl(var(--hover-background));
      color: hsl(var(--hover-foreground));
    }
    
    .date-nav-button:active {
      transform: translateY(1px);
    }
    
    /* Perfect Node Alignment System - CSS Variables Architecture */
    .node-viewer {
      /* Dynamic Circle Positioning System - All values configurable from here */
      --circle-offset: 22px;           /* Circle center distance from container left edge - reserves space for chevrons */
      --circle-diameter: 20px;         /* Circle size (width and height) */
      --circle-text-gap: 8px;          /* Gap between circle edge and text content */
      --node-indent: 2.5rem;           /* Indentation distance between parent and child levels */
      
      /* Base correction factor for text visual center alignment */
      --baseline-correction: -0.06375em;
    }
    
    .layout-demo {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 1rem;
      height: 400px;
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
      overflow: hidden;
    }
    
    .main-area {
      background: hsl(var(--background));
      padding: 1rem;
      overflow-y: auto;
    }
    
    .side-panel {
      background: hsl(var(--muted));
      border-left: 1px solid hsl(var(--border));
      padding: 1rem;
      overflow-y: auto;
    }
    
    .hierarchy-example {
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segue UI', Roboto, sans-serif;
      line-height: 1.6;
      margin: 1rem 0;
      padding-left: 0; /* Let CSS variables handle positioning - removed 1rem padding conflict */
      position: relative;
    }
    
    /* Hierarchy Node with Perfect Alignment System */
    .hierarchy-node {
      position: relative;
      cursor: pointer;
      border-radius: 0.25rem;
      transition: background-color 0.15s ease;
      /* Dynamic padding calculation: circle-offset + circle-diameter + circle-text-gap */
      padding-left: calc(var(--circle-offset, 22px) + var(--circle-diameter, 20px) + var(--circle-text-gap, 8px));
      padding-top: 0.25rem;
      padding-bottom: 0.25rem;
      min-height: calc(var(--circle-diameter, 20px) + 0.5rem); /* Ensure minimum height for circle */
      
      /* Default values for normal text (1rem × 1.6 = 1.6rem line-height) */
      --line-height: 1.6;
      --font-size: 1rem;
      --line-height-px: calc(var(--font-size) * var(--line-height));
    }
    
    
    /* Child Node Indentation System - Match Svelte implementation exactly */
    .hierarchy-node.child-1 {
      margin-left: 2.5rem; /* Single indentation level: 40px */
    }
    
    .hierarchy-node.child-2 {
      margin-left: 5rem; /* Double indentation level: 80px */
    }
    
    /* Circle Indicators - Use same system as BaseNode/TextNode sections */
    .hierarchy-indicator {
      position: absolute;
      left: var(--circle-offset, 22px);
      top: calc(0.25rem + (var(--line-height-px) / 2));
      transform: translateY(-50%);
      width: var(--circle-diameter, 20px);
      height: var(--circle-diameter, 20px);
      flex-shrink: 0;
      z-index: 2;
    }
    
    /* Use the exact same circle system for all node types */
    .hierarchy-indicator .task-icon,
    .hierarchy-indicator .node-icon {
      width: var(--circle-diameter, 20px);
      height: var(--circle-diameter, 20px);
      position: relative;
      display: block;
    }
    
    .hierarchy-indicator .text-circle {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: hsl(var(--primary));
      position: absolute;
      top: 2px;
      left: 2px;
    }
    
    .hierarchy-indicator .task-ring {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid hsl(var(--primary) / 0.5);
      box-sizing: border-box;
      position: absolute;
      top: 0;
      left: 0;
    }
    
    .interaction-demo {
      border: 2px dashed hsl(var(--border));
      border-radius: var(--radius);
      padding: 2rem;
      text-align: center;
      margin: 1rem 0;
      background: hsl(var(--muted));
    }
    
    .keyboard-shortcuts {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }
    
    .shortcut-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem;
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
    }
    
    .kbd {
      background: hsl(var(--background));
      padding: 0.125rem 0.375rem;
      border-radius: 0.25rem;
      border: 1px solid hsl(var(--border));
      font-family: var(--font-mono);
      font-size: 0.75rem;
      font-weight: 500;
    }
    
    .responsive-breakpoint {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
      margin: 0.5rem 0;
    }
    
    /* Date navigation buttons - subtle hover effect */
    .date-nav-button {
      padding: 0.5rem;
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
      background: hsl(var(--background));
      color: hsl(var(--muted-foreground));
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .date-nav-button:hover {
      background: hsl(var(--muted));
      color: hsl(var(--foreground));
    }
    
    .breakpoint-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: hsl(var(--primary));
      flex-shrink: 0;
    }
    
    /* Navigation Shell Styles */
    .shell-demo {
      display: flex;
      height: 300px;
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
      overflow: hidden;
      margin: 1rem 0;
    }
    
    .sidebar-collapsed {
      width: 48px;
      background: hsl(var(--background));
      border-right: 1px solid hsl(var(--border));
      display: flex;
      flex-direction: column;
      align-items: center; /* Center all content within the 48px panel */
      padding: 1rem 0; /* Remove left padding - center everything */
    }
    
    /* Collapsed sidebar specific nav items - perfect icon centering */
    .sidebar-collapsed .nav-item {
      display: flex;
      align-items: center;
      justify-content: center; /* Center the icons within the nav item */
      margin: 0;
      width: 100%; /* Full width for background highlights */
      padding: 0.5rem 0; /* Vertical padding only - NO horizontal padding */
      position: relative;
    }
    
    /* Collapsed sidebar active item - overlay accent without affecting icon position */
    .sidebar-collapsed .nav-item.active {
      /* DO NOT add padding-left - keep icon perfectly centered */
      border-left: none; /* Remove default border */
      padding-left: 0; /* Override general .nav-item.active padding-left */
      padding-right: 0; /* Ensure no horizontal padding */
    }
    
    .sidebar-collapsed .nav-item.active::before {
      content: '';
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0; /* Accent at the very left edge of the sidebar */
      width: 4px;
      background: hsl(var(--primary));
      /* Accent overlays without pushing content */
    }
    
    .sidebar-expanded {
      width: 240px; /* Good balance between functionality and size */
      background: hsl(var(--background));
      border-right: 1px solid hsl(var(--border));
      display: flex;
      flex-direction: column;
      padding: 1rem;
    }
    
    .hamburger-icon {
      width: 20px;
      height: 20px;
      margin-bottom: 1rem;
      cursor: pointer;
      flex-shrink: 0;
    }
    
    /* Consistent hamburger positioning - perfectly centered in collapsed sidebar */
    .sidebar-collapsed .hamburger-icon {
      margin-bottom: 0.5rem;
      /* Centered automatically by container align-items: center */
      /* Ensure consistent alignment with nav items */
    }
    
    .sidebar-expanded .hamburger-icon {
      margin-bottom: 0.5rem;
      width: 20px;
      height: 20px;
      align-self: flex-start;
      margin-left: calc(1rem - 18px); /* Move left to align with nav icons at same position */
    }
    
    .main-content {
      flex: 1;
      background: hsl(var(--background));
      padding: 1rem;
    }
    
    .nav-item {
      /* Full-width navigation items with no gaps */
      margin: 0 -1rem;
      padding: 0.5rem 1rem;
      border-radius: 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 0.75rem;
      height: 40px; /* Fixed height for consistent alignment */
      box-sizing: border-box;
      transition: background-color 0.2s, color 0.2s;
    }
    
    .nav-item:hover {
      background: hsl(var(--muted));
      color: hsl(var(--foreground));
    }
    
    .nav-item.active {
      background: hsl(var(--muted));
      color: hsl(var(--foreground));
      font-weight: 600;
      border-left: 4px solid hsl(var(--primary));
      padding-left: calc(1rem - 4px);
    }
    
    .nav-icon {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
    }
    
    /* TaskNode Circle Icon System */
    .task-icon-demo {
      display: flex;
      align-items: center;
      gap: 2rem;
      margin: 1rem 0;
      padding: 1rem;
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      border-radius: var(--radius);
    }
    
    .task-state-example {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
      text-align: center;
    }
    
    /* CSS-based task icons for consistent cross-browser rendering */
    .task-icon {
      width: var(--circle-diameter, 20px);
      height: var(--circle-diameter, 20px);
      position: relative;
      display: block;
    }
    
    /* Node icons - same styling as task icons but semantic naming */
    .node-icon {
      width: var(--circle-diameter, 20px);
      height: var(--circle-diameter, 20px);
      position: relative;
      display: block;
    }
    
    .task-icon-with-ring {
      width: calc(var(--circle-diameter, 20px) + 4px);
      height: calc(var(--circle-diameter, 20px) + 4px);
    }
    
    /* Basic circle states - Perfect 16x16 rendering */
    .task-circle {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      position: absolute;
      top: 2px;
      left: 2px;
    }
    
    .task-circle-pending {
      background: transparent;
      border: 1px solid hsl(var(--primary));
      box-sizing: border-box;
    }
    
    .task-circle-in-progress {
      background: linear-gradient(90deg, hsl(var(--primary)) 50%, transparent 50%);
      border: 1px solid hsl(var(--primary));
      box-sizing: border-box;
    }
    
    .task-circle-completed {
      background: hsl(var(--primary));
    }
    
    /* Checkmark for completed tasks - theme-aware stroke color */
    .task-circle-completed::after {
      content: "";
      position: absolute;
      left: 50%;
      top: 50%;
      width: 10px;
      height: 8px;
      transform: translate(-50%, -50%);
    }
    
    /* Checkmark for completed tasks - theme-aware colors */
    .task-circle-completed::after {
      content: "";
      position: absolute;
      left: 50%;
      top: 50%;
      width: 10px;
      height: 8px;
      transform: translate(-50%, -50%);
    }
    
    /* Light theme checkmark - matches #FAF9F5 */
    .task-circle-completed::after {
      background-image: url("data:image/svg+xml,%3Csvg width='10' height='8' viewBox='0 0 10 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 4L3.5 6.5L9 1' stroke='%23FAF9F5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
    }
    
    /* Dark theme checkmark - matches #252523 */
    .dark .task-circle-completed::after {
      background-image: url("data:image/svg+xml,%3Csvg width='10' height='8' viewBox='0 0 10 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 4L3.5 6.5L9 1' stroke='%23252523' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: center;
      background-size: contain;
    }
    
    /* Parent task rings */
    .task-ring {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid hsl(var(--primary) / 0.5);
      box-sizing: border-box;
      position: absolute;
      top: 0;
      left: 0;
    }
    
    /* Chevron icon for collapse/expand - Perfect vertical alignment using same formula as circles */
    .chevron-icon {
      position: absolute;
      /* Use exact same vertical positioning formula as circles for perfect alignment */
      top: calc(0.25rem + (var(--line-height-px) / 2));
      transform: translate(-50%, -50%); /* Center icon on coordinates - same as circles */
      width: 20px; /* 20x20 container like working implementation */
      height: 20px; /* 20x20 container like working implementation */
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s ease;
      z-index: 3;
      background: none;
      border: none;
      cursor: pointer;
    }
    
    /* Chevron positioned exactly halfway between parent and current node - match working implementation */
    /* All chevrons use the same positioning formula - they position relative to their own node */
    .hierarchy-node .chevron-icon {
      left: calc(var(--circle-offset) + var(--circle-diameter) / 2 - var(--node-indent) / 2); /* 22px + 10px - 20px = 12px */
    }
    
    .chevron-icon svg {
      width: 16px; /* 16x16 SVG inside 20x20 container */
      height: 16px; /* 16x16 SVG inside 20x20 container */
      fill: hsl(var(--primary)); /* Same color as node circles */
    }
    
    .chevron-icon.expanded {
      transform: translate(-50%, -50%) rotate(90deg);
    }
    
    /* Text Node circles - solid filled with perfect positioning */
    .text-circle {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: hsl(var(--primary));
      position: absolute;
      top: 2px;
      left: 2px;
    }
    
    /* Header-specific CSS variable definitions for font sizes and line heights */
    .hierarchy-node.h1 {
      --font-size: 2rem;
      --line-height: 1.2;
      --line-height-px: calc(var(--font-size) * var(--line-height));
      font-size: var(--font-size);
      line-height: var(--line-height);
      font-weight: 600;
      /* Baseline correction for H1 - larger fonts need more correction */
      transform: translateY(-0.05em);
    }
    
    .hierarchy-node.h2 {
      --font-size: 1.5rem;
      --line-height: 1.3;
      --line-height-px: calc(var(--font-size) * var(--line-height));
      font-size: var(--font-size);
      line-height: var(--line-height);
      font-weight: 600;
      /* Baseline correction for H2 - moderate correction */
      transform: translateY(-0.03em);
    }
    
    .hierarchy-node.h3 {
      --font-size: 1.25rem;
      --line-height: 1.4;
      --line-height-px: calc(var(--font-size) * var(--line-height));
      font-size: var(--font-size);
      line-height: var(--line-height);
      font-weight: 600;
      /* Baseline correction for H3 - smaller correction */
      transform: translateY(-0.02em);
    }
    
    /* Chevron positioning now handled automatically via CSS variables - no header-specific overrides needed */
    
    .task-state-label {
      font-size: 0.75rem;
      color: hsl(var(--muted-foreground));
      font-weight: 500;
    }

    /* Search term highlighting - theme-adaptive colors for proper contrast */
    .search-highlight {
      font-weight: 600;
      padding: 0 0.125rem;
      border-radius: 0.125rem;
    }
    
    /* Light mode: warm gray search highlight */
    :root .search-highlight {
      background: hsl(25 15% 88%);
      color: hsl(25 25% 25%);
    }
    
    /* Dark mode: warm gray search highlight */
    .dark .search-highlight {
      background: hsl(25 15% 25%);
      color: hsl(25 25% 80%);
    }
    
    /* Blinking cursor animation */
    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
    
    /* Fixed SVG sizing for navigation shell */
    .shell-demo .hamburger-icon {
      width: 20px;
      height: 20px;
    }
    
    .shell-demo .nav-icon {
      width: 16px;
      height: 16px;
    }
    
    /* AI Chat Node Icon System - Square with punch-hole "AI" text */
    .ai-icon {
      width: var(--circle-diameter, 20px);
      height: var(--circle-diameter, 20px);
      position: relative;
      display: block;
    }
    
    .ai-square {
      width: 16px;
      height: 16px;
      background: hsl(var(--primary));
      border-radius: 0.5px;
      position: absolute;
      top: 2px;
      left: 2px;
      overflow: hidden;
    }
    
    /* AI punch-hole effect using background image with blend mode */
    .ai-square::after {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 -960 960 960'%3E%3Cpath d='M80-120v-80h800v80H80Zm680-160v-560h60v560h-60Zm-600 0 210-560h100l210 560h-96l-50-144H308l-52 144h-96Zm176-224h168l-82-232h-4l-82 232Z' fill='white'/%3E%3C/svg%3E");
      background-size: 14px 14px;
      background-position: center;
      background-repeat: no-repeat;
      mix-blend-mode: multiply;
    }
    
    /* Alternative approach for better browser support */
    .ai-square-alt {
      width: 16px;
      height: 16px;
      position: absolute;
      top: 2px;
      left: 2px;
      border-radius: 0.5px;
      overflow: hidden;
    }
    
    .ai-square-alt::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: hsl(var(--primary));
    }
    
    .ai-square-alt::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 14px;
      height: 14px;
      transform: translate(-50%, -50%);
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 -960 960 960'%3E%3Cpath d='M80-120v-80h800v80H80Zm680-160v-560h60v560h-60Zm-600 0 210-560h100l210 560h-96l-50-144H308l-52 144h-96Zm176-224h168l-82-232h-4l-82 232Z' fill='%23FAF9F5'/%3E%3C/svg%3E");
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    /* Dark theme version */
    .dark .ai-square-alt::after {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 -960 960 960'%3E%3Cpath d='M80-120v-80h800v80H80Zm680-160v-560h60v560h-60Zm-600 0 210-560h100l210 560h-96l-50-144H308l-52 144h-96Zm176-224h168l-82-232h-4l-82 232Z' fill='%23252523'/%3E%3C/svg%3E");
    }
    
    /* Header Square Icons - H1, H2, H3 with punch-hole text effect */
    .h1-square-alt,
    .h2-square-alt,
    .h3-square-alt {
      width: 16px;
      height: 16px;
      position: absolute;
      top: 2px;
      left: 2px;
      border-radius: 0.5px;
      overflow: hidden;
    }
    
    .h1-square-alt::before,
    .h2-square-alt::before,
    .h3-square-alt::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: hsl(var(--primary));
    }
    
    .h1-square-alt::after,
    .h2-square-alt::after,
    .h3-square-alt::after {
      content: "";
      position: absolute;
      top: 50%;
      left: 50%;
      width: 14px;
      height: 14px;
      transform: translate(-50%, -50%);
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .h1-square-alt::after {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ctext x='10' y='12.5' fill='%23FAF9F5' text-anchor='middle' dominant-baseline='middle' font-family='-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif' font-size='16' font-weight='400'%3EH1%3C/text%3E%3C/svg%3E");
    }
    
    .h2-square-alt::after {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ctext x='10' y='12.5' fill='%23FAF9F5' text-anchor='middle' dominant-baseline='middle' font-family='-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif' font-size='16' font-weight='400'%3EH2%3C/text%3E%3C/svg%3E");
    }
    
    .h3-square-alt::after {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ctext x='10' y='12.5' fill='%23FAF9F5' text-anchor='middle' dominant-baseline='middle' font-family='-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif' font-size='16' font-weight='400'%3EH3%3C/text%3E%3C/svg%3E");
    }
    
    .dark .h1-square-alt::after {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ctext x='10' y='12.5' fill='%23252523' text-anchor='middle' dominant-baseline='middle' font-family='-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif' font-size='16' font-weight='400'%3EH1%3C/text%3E%3C/svg%3E");
    }
    
    .dark .h2-square-alt::after {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ctext x='10' y='12.5' fill='%23252523' text-anchor='middle' dominant-baseline='middle' font-family='-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif' font-size='16' font-weight='400'%3EH2%3C/text%3E%3C/svg%3E");
    }
    
    .dark .h3-square-alt::after {
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20'%3E%3Ctext x='10' y='12.5' fill='%23252523' text-anchor='middle' dominant-baseline='middle' font-family='-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif' font-size='16' font-weight='400'%3EH3%3C/text%3E%3C/svg%3E");
    }
    
    /* AI Square Ring for parent nodes */
    .ai-square-ring {
      width: 20px;
      height: 20px;
      border-radius: 1px;
      border: 2px solid hsl(var(--primary) / 0.5);
      box-sizing: border-box;
      position: absolute;
      top: 0;
      left: 0;
    }
    
    /* Copy button styling for code examples - ensure visibility in both light and dark modes */
    .example-code {
      position: relative;
    }
    
    .example-code .copy-button {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      color: hsl(var(--foreground));
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      cursor: pointer;
      z-index: 10;
      transition: background-color 0.2s ease, border-color 0.2s ease;
    }
    
    .example-code .copy-button:hover {
      background: hsl(var(--muted));
      border-color: hsl(var(--primary));
    }
    
    .example-code .copy-button:active {
      background: hsl(var(--muted));
      transform: translateY(1px);
    }
    
    /* Ensure copy button is visible in dark mode */
    .dark .example-code .copy-button {
      background: hsl(var(--background));
      border: 1px solid hsl(var(--border));
      color: hsl(var(--foreground));
    }
    
    .dark .example-code .copy-button:hover {
      background: hsl(var(--muted));
      border-color: hsl(var(--primary));
      color: hsl(var(--foreground));
    }
  </style>
</head>
<body class="no-transitions">
  <div class="style-guide">
    <!-- Header -->
    <header>
      <h1>Patterns</h1>
      <p>Layout patterns, interaction behaviors, and responsive design guidelines for consistent NodeSpace user experiences.</p>
    </header>

    <!-- Navigation -->
    <nav class="style-guide-nav">
      <a href="index.html">Overview</a>
      <a href="foundations.html">Foundations</a>
      <a href="components.html">Components</a>
      <a href="patterns.html" class="active">Patterns</a>
      <a href="nodeviewer.html">NodeViewer</a>
      
      <div class="theme-toggle">
        <!-- Theme toggle buttons will be generated by JavaScript -->
      </div>
    </nav>

    <!-- Navigation Shell -->
    <section class="example-section">
      <h2>Navigation Shell</h2>
      <p>Collapsible sidebar navigation with hamburger menu, matching the design from your application screenshots.</p>
      <p><strong>Alignment:</strong> Hamburger icons maintain consistent horizontal alignment with navigation icons in both collapsed and expanded states (20x20px sizing).</p>
      
      <h3>Collapsed Sidebar</h3>
      <div class="shell-demo">
        <div class="sidebar-collapsed">
          <!-- Hamburger Icon SVG -->
          <svg class="hamburger-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
          
          <!-- Navigation Icons -->
          <div class="nav-item active">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            </svg>
          </div>
          <div class="nav-item">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="9" y1="15" x2="15" y2="15"></line>
            </svg>
          </div>
          <div class="nav-item">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
          </div>
        </div>
        <div class="main-content">
          <p>Main content area with collapsed sidebar (48px width)</p>
        </div>
      </div>
      
      <h3>Expanded Sidebar</h3>
      <div class="shell-demo">
        <div class="sidebar-expanded">
          <!-- Hamburger Icon SVG -->
          <svg class="hamburger-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
          </svg>
          
          <!-- Navigation Items with Labels -->
          <div class="nav-item active">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            </svg>
            <span>Daily Journal</span>
          </div>
          <div class="nav-item">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="9" y1="15" x2="15" y2="15"></line>
            </svg>
            <span>Dashboard</span>
          </div>
          <div class="nav-item">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <span>Search</span>
          </div>
          <div class="nav-item">
            <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polygon points="12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26"></polygon>
            </svg>
            <span>Favorites</span>
          </div>
        </div>
        <div class="main-content">
          <p>Main content with expanded sidebar (240px width)</p>
        </div>
      </div>
      
      <h3>Technical Implementation Details</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">Perfect Icon Alignment System</div>
          <div class="component-demo">
            <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
              <p style="margin: 0 0 0.5rem 0; font-weight: 500;">DOM-Measured Precision Alignment</p>
              <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                <li><strong>Collapsed State:</strong> Icons perfectly centered at 24.0px within 48px sidebar container</li>
                <li><strong>Active Accent:</strong> Left border overlay with zero horizontal padding to preserve centering</li>
                <li><strong>Expanded Consistency:</strong> Icons maintain exact collapsed positions when sidebar expands</li>
                <li><strong>Mathematical Precision:</strong> Used Playwright DOM measurements to achieve pixel-perfect alignment</li>
              </ul>
            </div>
            
            <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
              <thead>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <th style="padding: 0.5rem; text-align: left;">Element</th>
                  <th style="padding: 0.5rem; text-align: left;">Position</th>
                  <th style="padding: 0.5rem; text-align: left;">Result</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Hamburger Icon</td>
                  <td style="padding: 0.5rem;"><code>center: 24.0px</code></td>
                  <td style="padding: 0.5rem;">Perfect centering within 48px sidebar</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Active Nav Item</td>
                  <td style="padding: 0.5rem;"><code>center: 24.0px</code></td>
                  <td style="padding: 0.5rem;">No offset from accent border (overlay method)</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Inactive Nav Items</td>
                  <td style="padding: 0.5rem;"><code>center: 24.0px</code></td>
                  <td style="padding: 0.5rem;">Consistent alignment across all nav items</td>
                </tr>
                <tr>
                  <td style="padding: 0.5rem;">Left Accent Border</td>
                  <td style="padding: 0.5rem;"><code>position: absolute; left: 0</code></td>
                  <td style="padding: 0.5rem;">Overlays without affecting icon position</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- BaseNode/TextNode Icon System -->
    <section class="example-section">
      <h2>BaseNode/TextNode Icon System</h2>
      <p>Solid circle icons with ring effects for nodes that have children.</p>
      
      <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
        <p style="margin: 0 0 0.5rem 0; font-weight: 500;">Icon Container Classes</p>
        <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
          <li><strong>node-icon:</strong> Use for text nodes and other general node types (16x16px circle)</li>
          <li><strong>task-icon:</strong> Use specifically for task nodes with state indicators</li>
          <li><strong>ai-icon:</strong> Use specifically for AI chat nodes with square design</li>
        </ul>
        <p style="margin: 0.5rem 0 0 0; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
          <strong>Important:</strong> Text nodes should use <code>node-icon</code> + <code>text-circle</code>, not <code>task-icon</code> wrapper classes.
        </p>
      </div>
      
      <h3>Text Node States</h3>
      <div class="task-icon-demo">
        <!-- Regular Text Node -->
        <div class="task-state-example">
          <div class="node-icon">
            <div class="text-circle"></div>
          </div>
          <div class="task-state-label">Text Node</div>
        </div>
        
        <!-- Text Node with Children (Ring Effect) -->
        <div class="task-state-example">
          <div class="node-icon">
            <div class="task-ring"></div>
            <div class="text-circle"></div>
          </div>
          <div class="task-state-label">Text Node (Parent)</div>
        </div>
      </div>
      
      <h3>Implementation Code</h3>
      <div class="example-code">
        <pre><code><!-- Regular Text Node -->
&lt;div class="node-icon"&gt;
  &lt;div class="text-circle"&gt;&lt;/div&gt;
&lt;/div&gt;

<!-- Text Node with Children (Ring Effect) -->
&lt;div class="node-icon"&gt;
  &lt;div class="task-ring"&gt;&lt;/div&gt;
  &lt;div class="text-circle"&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
      </div>
    </section>

    <!-- TaskNode Icon System -->
    <section class="example-section">
      <h2>TaskNode Icon System</h2>
      <p>Circle-based icons for TaskNode states with punch-hole checkmark design and ring effects for parent nodes.</p>
      
      <h3>Basic Task States</h3>
      <div class="task-icon-demo">
        <!-- Pending Task -->
        <div class="task-state-example">
          <div class="task-icon">
            <div class="task-circle task-circle-pending"></div>
          </div>
          <div class="task-state-label">Pending</div>
        </div>
        
        <!-- In Progress Task -->
        <div class="task-state-example">
          <div class="task-icon">
            <div class="task-circle task-circle-in-progress"></div>
          </div>
          <div class="task-state-label">In Progress</div>
        </div>
        
        <!-- Completed Task -->
        <div class="task-state-example">
          <div class="task-icon">
            <div class="task-circle task-circle-completed"></div>
          </div>
          <div class="task-state-label">Completed</div>
        </div>
      </div>
      
      <h3>Parent Task States (with Ring Effect)</h3>
      <div class="task-icon-demo">
        <!-- Pending Parent Task -->
        <div class="task-state-example">
          <div class="task-icon">
            <div class="task-ring"></div>
            <div class="task-circle task-circle-pending"></div>
          </div>
          <div class="task-state-label">Pending Parent</div>
        </div>
        
        <!-- In Progress Parent Task -->
        <div class="task-state-example">
          <div class="task-icon">
            <div class="task-ring"></div>
            <div class="task-circle task-circle-in-progress"></div>
          </div>
          <div class="task-state-label">In Progress Parent</div>
        </div>
        
        <!-- Completed Parent Task -->
        <div class="task-state-example">
          <div class="task-icon">
            <div class="task-ring"></div>
            <div class="task-circle task-circle-completed"></div>
          </div>
          <div class="task-state-label">Completed Parent</div>
        </div>
      </div>
      
      <h3>Implementation Code (CSS-based for Cross-Browser Consistency)</h3>
      <div class="example-code">
        <pre><code><!-- Pending Task -->
&lt;div class="task-icon"&gt;
  &lt;div class="task-circle task-circle-pending"&gt;&lt;/div&gt;
&lt;/div&gt;

<!-- In Progress Task -->
&lt;div class="task-icon"&gt;
  &lt;div class="task-circle task-circle-in-progress"&gt;&lt;/div&gt;
&lt;/div&gt;

<!-- Completed Task -->
&lt;div class="task-icon"&gt;
  &lt;div class="task-circle task-circle-completed"&gt;&lt;/div&gt;
&lt;/div&gt;

<!-- Task with Children (Ring Effect) -->
&lt;div class="task-icon"&gt;
  &lt;div class="task-ring"&gt;&lt;/div&gt;
  &lt;div class="task-circle task-circle-pending"&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
      </div>
    </section>

    <!-- AI Chat Node Icon System -->
    <section class="example-section">
      <h2>AI Chat Node Icon System</h2>
      <p>Square-based icons for AI Chat Nodes with punch-hole "AI" text design and ring effects for parent nodes.</p>
      
      <h3>Basic AI Chat States</h3>
      <div class="task-icon-demo">
        <!-- Regular AI Chat Node -->
        <div class="task-state-example">
          <div class="ai-icon">
            <div class="ai-square-alt"></div>
          </div>
          <div class="task-state-label">AI Chat Node</div>
        </div>
        
        <!-- AI Chat Node with Children (Ring Effect) -->
        <div class="task-state-example">
          <div class="ai-icon">
            <div class="ai-square-ring"></div>
            <div class="ai-square-alt"></div>
          </div>
          <div class="task-state-label">AI Chat Node (Parent)</div>
        </div>
      </div>
      
      <h3>Implementation Code (CSS-based with Punch-hole Effect)</h3>
      <div class="example-code">
        <pre><code><!-- Regular AI Chat Node -->
&lt;div class="ai-icon"&gt;
  &lt;div class="ai-square-alt"&gt;&lt;/div&gt;
&lt;/div&gt;

<!-- AI Chat Node with Children (Ring Effect) -->
&lt;div class="ai-icon"&gt;
  &lt;div class="ai-square-ring"&gt;&lt;/div&gt;
  &lt;div class="ai-square-alt"&gt;&lt;/div&gt;
&lt;/div&gt;</code></pre>
      </div>
      
      <h3>Technical Implementation Details</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">Punch-hole Effect</div>
          <div class="component-demo">
            <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
              <p style="margin: 0 0 0.5rem 0; font-weight: 500;">CSS Mask Implementation</p>
              <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                <li>16x16px filled square with primary color (#A8C7FA)</li>
                <li>0.5px border-radius for subtle rounded corners</li>
                <li>14x14px "AI" text with punch-hole effect (1px spacing on each side)</li>
                <li>Background color shows through AI letters (like task checkmarks)</li>
                <li>Cross-browser compatibility with -webkit-mask fallback</li>
              </ul>
            </div>
            
            <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
              <thead>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <th style="padding: 0.5rem; text-align: left;">Element</th>
                  <th style="padding: 0.5rem; text-align: left;">Size</th>
                  <th style="padding: 0.5rem; text-align: left;">Purpose</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">AI Icon Container</td>
                  <td style="padding: 0.5rem;"><code>20x20px</code></td>
                  <td style="padding: 0.5rem;">Standard icon container size</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">AI Square (regular)</td>
                  <td style="padding: 0.5rem;"><code>16x16px + 0.5px radius</code></td>
                  <td style="padding: 0.5rem;">Filled square with punch-hole AI text</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">AI Square (with children)</td>
                  <td style="padding: 0.5rem;"><code>16x16px inner + 20x20px ring</code></td>
                  <td style="padding: 0.5rem;">Filled square with 50% opacity ring</td>
                </tr>
                <tr>
                  <td style="padding: 0.5rem;">Ring Border</td>
                  <td style="padding: 0.5rem;"><code>2px + 1px radius</code></td>
                  <td style="padding: 0.5rem;">Semi-transparent square ring effect</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        
        <div class="component-example">
          <div class="component-title">Design Rationale</div>
          <div class="component-demo">
            <ul>
              <li><strong>Square Shape:</strong> Distinguishes AI nodes from circular text/task nodes</li>
              <li><strong>Punch-hole Text:</strong> "AI" letters cut out to show background, similar to task checkmarks</li>
              <li><strong>Bold 'A' vs Thin 'I':</strong> Original icon design maintains visual hierarchy</li>
              <li><strong>Consistent Sizing:</strong> 16x16 active area within 20x20 container matches other icons</li>
              <li><strong>Theme Adaptive:</strong> Works in both light and dark modes automatically</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Icon System Specifications -->
    <section class="example-section">
      <h2>Icon System Specifications</h2>
      <p>Standardized sizing and effects for all NodeSpace icons across the application.</p>
      
      <h3>Standard Dimensions</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">Icon Container</div>
          <div class="component-demo">
            <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
              <thead>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <th style="padding: 0.5rem; text-align: left;">Element</th>
                  <th style="padding: 0.5rem; text-align: left;">Size</th>
                  <th style="padding: 0.5rem; text-align: left;">Purpose</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Container</td>
                  <td style="padding: 0.5rem;"><code>20x20px</code></td>
                  <td style="padding: 0.5rem;">Standard icon container size</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">TextNode (regular)</td>
                  <td style="padding: 0.5rem;"><code>r="7.5" (15x15px)</code></td>
                  <td style="padding: 0.5rem;">Solid filled circle, centered in 20x20 container</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">TaskNode (regular)</td>
                  <td style="padding: 0.5rem;"><code>r="7.5" + 1px stroke (16x16px)</code></td>
                  <td style="padding: 0.5rem;">Stroked circle, centered in 20x20 container</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">TextNode (with children)</td>
                  <td style="padding: 0.5rem;"><code>r="7.5" inner + r="8.5" ring</code></td>
                  <td style="padding: 0.5rem;">Solid inner with 50% opacity ring</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">TaskNode (with children)</td>
                  <td style="padding: 0.5rem;"><code>r="7.5" inner + r="8.5" ring</code></td>
                  <td style="padding: 0.5rem;">Stroked/filled inner with 50% opacity ring</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">AI Chat Node (regular)</td>
                  <td style="padding: 0.5rem;"><code>16x16px square + 0.5px radius</code></td>
                  <td style="padding: 0.5rem;">Filled square with punch-hole AI text</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">AI Chat Node (with children)</td>
                  <td style="padding: 0.5rem;"><code>16x16px inner + 20x20px square ring</code></td>
                  <td style="padding: 0.5rem;">Filled square with 50% opacity square ring</td>
                </tr>
                <tr>
                  <td style="padding: 0.5rem;">Ring Opacity</td>
                  <td style="padding: 0.5rem;"><code>50%</code></td>
                  <td style="padding: 0.5rem;">Semi-transparent ring effect</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <h3>Cross-Browser Rendering Behavior</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">SVG Circle Rendering Notes</div>
          <div class="component-demo">
            <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
              <p style="margin: 0 0 0.5rem 0; font-weight: 500;">Universal Rendering Solution</p>
              <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                <li>Single implementation works consistently across all browsers</li>
                <li>Hardware acceleration prevents Safari's aggressive anti-aliasing</li>
                <li>All circles render at exactly 16x16 pixels</li>
                <li>Parent rings fit perfectly within 20x20 containers without clipping</li>
              </ul>
            </div>
            
            <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
              <thead>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <th style="padding: 0.5rem; text-align: left;">Browser</th>
                  <th style="padding: 0.5rem; text-align: left;">Rendering Approach</th>
                  <th style="padding: 0.5rem; text-align: left;">CSS Fix Applied</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Chrome/Edge</td>
                  <td style="padding: 0.5rem;">Larger radius (r=8) to achieve same 16x16 visual</td>
                  <td style="padding: 0.5rem;"><code>Dual-circle with browser detection</code></td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Firefox</td>
                  <td style="padding: 0.5rem;">Crisp edges without positioning offset</td>
                  <td style="padding: 0.5rem;"><code>shape-rendering: crispEdges</code></td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Safari</td>
                  <td style="padding: 0.5rem;">Hardware acceleration optimization</td>
                  <td style="padding: 0.5rem;"><code>will-change: transform</code></td>
                </tr>
              </tbody>
            </table>
            
            <p style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); margin: 1rem 0 0 0;">
              <strong>Technical Solution:</strong> Universal dimensions with hardware acceleration (<code>transform: translateZ(0)</code>)
              prevent Safari's aggressive anti-aliasing. All circles use r="8" for 16x16 rendering, parent rings use r="9" 
              with stroke-width="2" for perfect 20x20 boundaries. Integer positioning (cx="10" cy="10") eliminates 
              sub-pixel rendering inconsistencies.
            </p>
          </div>
        </div>
      </div>
      
      <h3>Border Specifications</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">Stroke Weights</div>
          <div class="component-demo">
            <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
              <thead>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <th style="padding: 0.5rem; text-align: left;">Element</th>
                  <th style="padding: 0.5rem; text-align: left;">Stroke Width</th>
                  <th style="padding: 0.5rem; text-align: left;">Usage</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">TaskNode Border</td>
                  <td style="padding: 0.5rem;"><code>1px</code></td>
                  <td style="padding: 0.5rem;">Clean task circle outline</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Parent Ring</td>
                  <td style="padding: 0.5rem;"><code>2px</code></td>
                  <td style="padding: 0.5rem;">Prominent ring for parent indication</td>
                </tr>
                <tr>
                  <td style="padding: 0.5rem;">Checkmark</td>
                  <td style="padding: 0.5rem;"><code>2px</code></td>
                  <td style="padding: 0.5rem;">Bold checkmark for completed tasks</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- Layout Patterns -->
    <section class="example-section">
      <h2>Multi-Pane Layout System</h2>
      <p>Advanced layout patterns for NodeSpace's desktop application featuring sidebar navigation and up to 3 content panes with tab management.</p>
      
      <h3>Application Layout Structure</h3>
      <div class="layout-demo" style="
        background: hsl(var(--background));
        border: 1px solid hsl(var(--border));
        border-radius: var(--radius);
        padding: 1rem;
        margin: 1.5rem 0;
        font-family: monospace;
        font-size: 0.875rem;
        line-height: 1.4;
        height: auto;
      ">
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">┌─[Sidebar 280px]──┬─[Pane 1]────┬─[Pane 2]────┬─[Pane 3]────┐</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│ Daily Journal     │ [Today]     │ [Tasks]     │ [Library]   │</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│ Dashboard         │ [Project ▼] │ [Notes]     │ [Team]      │</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│ Search            │─────────────┼─────────────┼─────────────┤</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│ Favorites         │ Content     │ Task List   │ Resources   │</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│ Recent            │             │             │             │</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│                  │ ● Morning   │ ☐ Review    │ Projects    │</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│ Library           │   Planning  │   Designs   │ Team        │</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│   ├─ Clients      │ AI Help     │ ◒ Client    │ Links       │</div>
        <div style="color: hsl(var(--muted-foreground)); margin-bottom: 0.5rem;">│   └─ Projects     │             │   Feedback  │             │</div>
        <div style="color: hsl(var(--muted-foreground));">└───────────────────┴─────────────┴─────────────┴─────────────┘</div>
      </div>
      
      <h3>Browser-Like Tab System</h3>
      <p>Each content pane supports multiple tabs with intelligent title management, browser-like behaviors, and refined interaction states.</p>
      <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin: 1rem 0;">
        <p style="margin: 0 0 0.5rem 0; font-weight: 500;">Key Features</p>
        <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
          <li><strong>Subtle Hover States:</strong> Inactive tabs use <code>--border</code> color on hover for gentle visual feedback</li>
          <li><strong>Instant State Changes:</strong> All transitions disabled globally for immediate response</li>
          <li><strong>Precise Border Handling:</strong> Box-shadow borders prevent mitered corners and allow seamless active tab integration</li>
          <li><strong>Primary Accent:</strong> 4px top border on active tab extends to browser edge for clear visual hierarchy</li>
          <li><strong>Responsive Layout:</strong> Truncated titles (~25 characters) with full title on hover tooltip</li>
        </ul>
      </div>
      
      <h4>Interaction States</h4>
      <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
        <thead>
          <tr style="border-bottom: 1px solid hsl(var(--border));">
            <th style="padding: 0.5rem; text-align: left;">Tab State</th>
            <th style="padding: 0.5rem; text-align: left;">Background</th>
            <th style="padding: 0.5rem; text-align: left;">Text Color</th>
            <th style="padding: 0.5rem; text-align: left;">Hover Behavior</th>
          </tr>
        </thead>
        <tbody>
          <tr style="border-bottom: 1px solid hsl(var(--border));">
            <td style="padding: 0.5rem; font-weight: 500;">Inactive</td>
            <td style="padding: 0.5rem;"><code>transparent</code></td>
            <td style="padding: 0.5rem;"><code>--muted-foreground</code></td>
            <td style="padding: 0.5rem;"><code>--border</code> bg + <code>--foreground</code> text</td>
          </tr>
          <tr>
            <td style="padding: 0.5rem; font-weight: 500;">Active</td>
            <td style="padding: 0.5rem;"><code>--background</code></td>
            <td style="padding: 0.5rem;"><code>--foreground</code></td>
            <td style="padding: 0.5rem;">No change (maintains state)</td>
          </tr>
        </tbody>
      </table>
      
      <p><strong>Technical Implementation:</strong> Tab titles are vertically centered within 40px height tabs using <code>display: flex</code> and <code>align-items: center</code>. Border system uses <code>box-shadow: inset</code> to prevent mitered corners and allows precise control over active tab integration with content area.</p>
      
      <h4>Date Header Format</h4>
      <p>Date node viewers feature a prominent header with large typography and semantic calendar iconography:</p>
      <ul>
        <li><strong>Typography:</strong> 2rem font size with 500 font weight for visual hierarchy</li>
        <li><strong>Format:</strong> Clean date presentation (e.g., "September 7, 2025") without prefixes</li>
        <li><strong>Semantic HTML:</strong> Uses <code>&lt;h1&gt;</code> element with zero margin for proper document structure</li>
        <li><strong>Color:</strong> Uses <code>hsl(var(--muted-foreground))</code> for subtle but readable text</li>
      </ul>
      
      <h4>Icon System Integration</h4>
      <p>Icons are rendered using the NodeSpace Icon component system with consistent styling:</p>
      <ul>
        <li><strong>Calendar Icon:</strong> Uses semantic <code>calendar</code> icon with 18px size and 0.8 opacity</li>
        <li><strong>CSS Classes:</strong> Applies <code>ns-icon ns-icon--calendar calendar-icon</code> for styling hooks</li>
        <li><strong>Accessibility:</strong> Includes proper <code>role="img"</code> and <code>aria-label</code> attributes</li>
        <li><strong>Rendering:</strong> Uses exact path data from icon registry for consistency across components</li>
      </ul>
      
      <div class="node-viewer" style="border: 1px solid hsl(var(--border)); border-radius: var(--radius); height: 500px; overflow: hidden; padding: 0; background: transparent;">
        <!-- Tab Bar Example -->
        <div style="
          height: 40px;
          background: hsl(var(--muted));
          border-bottom: 1px solid hsl(var(--border));
          display: flex;
          align-items: stretch;
        ">
          <!-- Active tab: "Today" -->
          <div style="
            padding: 0 1rem;
            background: hsl(var(--background));
            border-right: 1px solid hsl(var(--border));
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: hsl(var(--foreground));
            font-weight: 600;
            position: relative;
            z-index: 2;
            margin-bottom: -1px;
          ">
            Today
            <div style="
              position: absolute;
              top: 0;
              left: 0;
              right: 0;
              height: 4px;
              background: hsl(var(--primary));
            "></div>
          </div>
          <!-- Inactive tab: "Acme Corp Strategy" -->
          <div style="
            padding: 0 1rem;
            background: transparent;
            border-right: 1px solid hsl(var(--border));
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            cursor: pointer;
            transition: none;
          " onmouseover="this.style.backgroundColor='hsl(var(--border))'; this.style.color='hsl(var(--foreground))'"
             onmouseout="this.style.backgroundColor='transparent'; this.style.color='hsl(var(--muted-foreground))'">Acme Corp Strategy</div>
          <!-- Inactive tab: "Q2 Tasks" -->
          <div style="
            padding: 0 1rem;
            background: transparent;
            border-right: 1px solid hsl(var(--border));
            display: flex;
            align-items: center;
            font-size: 0.875rem;
            color: hsl(var(--muted-foreground));
            cursor: pointer;
            transition: none;
          " onmouseover="this.style.backgroundColor='hsl(var(--border))'; this.style.color='hsl(var(--foreground))'"
             onmouseout="this.style.backgroundColor='transparent'; this.style.color='hsl(var(--muted-foreground))'">Q2 Tasks (Truncated...)</div>
        </div>
        
        <!-- Main Content Area with Hierarchical Nodes -->
        <div style="
          flex: 1;
          background: hsl(var(--background));
          padding: 0;
          overflow-y: auto;
          height: calc(500px - 40px);
        ">
          <!-- DateNode Header Section -->
          <div style="
            background: hsl(var(--background));
            padding: 1.5rem;
            border-bottom: 1px solid hsl(var(--border));
            display: flex;
            align-items: center;
            justify-content: space-between;
          ">
            <!-- Date Display -->
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              <svg stroke-width="2" role="img" width="18" height="18" viewBox="0 0 24 24" fill="hsl(var(--muted-foreground))" stroke="hsl(var(--muted-foreground))" class="ns-icon ns-icon--calendar calendar-icon" aria-label="calendar icon" style="opacity: 0.8;">
                <path fill="none" stroke-width="2" d="M5 4V2C5 1.4 5.4 1 6 1S7 1.4 7 2V4M17 4V2C17 1.4 17.4 1 18 1S19 1.4 19 2V4M3 8H21M5 4H19C20.1 4 21 4.9 21 6V20C21 21.1 20.1 22 19 22H5C3.9 22 3 21.1 3 20V6C3 4.9 3.9 4 5 4Z" stroke="hsl(var(--muted-foreground))"></path>
              </svg>
              <h1 style="font-size: 2rem; font-weight: 500; color: hsl(var(--muted-foreground)); margin: 0;">September 7, 2025</h1>
            </div>
            
            <!-- Navigation Controls -->
            <div style="display: flex; gap: 0.5rem;">
              <!-- Previous Date Button -->
              <button class="date-nav-button">
                <svg style="width: 16px; height: 16px; color: currentColor;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="15,18 9,12 15,6"></polyline>
                </svg>
              </button>
              
              <!-- Next Date Button -->
              <button class="date-nav-button">
                <svg style="width: 16px; height: 16px; color: currentColor;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="9,18 15,12 9,6"></polyline>
                </svg>
              </button>
            </div>
          </div>
          
          <!-- Main Content Area - no borders, tab system owns styling -->
          <div class="node-viewer" style="border: none; border-radius: 0; padding: 0.5rem 1.5rem 1.5rem 1.5rem; background: transparent;">
            <div class="hierarchy-example">
          
          <!-- Morning Planning Section -->
          <div class="hierarchy-node has-children">
            <span class="chevron-icon expanded">
              <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3l5 5-5 5-1-1 4-4-4-4 1-1z"/>
              </svg>
            </span>
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="task-ring"></div>
                <div class="text-circle"></div>
              </div>
            </div>
            Morning Planning
          </div>
          
          <!-- Planning items -->
          <div class="hierarchy-node child-1">
            <div class="hierarchy-indicator">
              <div class="task-icon">
                <div class="task-circle task-circle-completed"></div>
              </div>
            </div>
            <span style="text-decoration: line-through; opacity: 0.7;">Review yesterday's progress and blockers</span>
          </div>
          
          <div class="hierarchy-node child-1">
            <div class="hierarchy-indicator">
              <div class="task-icon">
                <div class="task-circle task-circle-in-progress"></div>
              </div>
            </div>
            Set priorities for today's development work
          </div>
          
          <div class="hierarchy-node child-1">
            <div class="hierarchy-indicator">
              <div class="task-icon">
                <div class="task-circle task-circle-pending"></div>
              </div>
            </div>
            Check team status and coordinate on shared tasks
          </div>
          
          <!-- AI Chat Section -->
          <div class="hierarchy-node has-children">
            <span class="chevron-icon expanded">
              <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3l5 5-5 5-1-1 4-4-4-4 1-1z"/>
              </svg>
            </span>
            <div class="hierarchy-indicator">
              <div class="ai-icon">
                <div class="ai-square-ring"></div>
                <div class="ai-square-alt"></div>
              </div>
            </div>
            What should I prioritize for the Acme Corp project?
          </div>
          
          <div class="hierarchy-node child-1">
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="text-circle"></div>
              </div>
            </div>
            Based on your timeline, I'd focus on the user research phase first. You have stakeholder interviews scheduled this week, and getting those insights early will inform the technical architecture decisions.
          </div>
          
          <!-- Notes Section -->
          <div class="hierarchy-node child-1">
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="text-circle"></div>
              </div>
            </div>
            <strong>Key Insights:</strong> The client emphasized mobile-first approach and real-time collaboration features
          </div>
          
          <!-- Project Tasks -->
          <div class="hierarchy-node has-children">
            <span class="chevron-icon">
              <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3l5 5-5 5-1-1 4-4-4-4 1-1z"/>
              </svg>
            </span>
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="task-ring"></div>
                <div class="text-circle"></div>
              </div>
            </div>
            Acme Corp Sprint Items (Collapsed)
          </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Features Description -->
      <div style="margin-top: 1.5rem; padding: 1.5rem; background: hsl(var(--muted)); border-radius: var(--radius);">
        <h4 style="margin: 0 0 1rem 0; color: hsl(var(--foreground));">Tab Content Features</h4>
        <div style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); line-height: 1.6;">
          <p><strong>Single Tab:</strong> No tab bar shown, content fills full area</p>
          <p><strong>Multiple Tabs:</strong> Tab bar appears with truncated titles (~25 characters)</p>
          <p><strong>Active Tab:</strong> White background with primary accent border, no hover changes</p>
          <p><strong>Inactive Tabs:</strong> Transparent background, subtle border color hover effect</p>
          <p><strong>Instant Interactions:</strong> All state changes happen immediately without animation delays</p>
          <p><strong>New Tab Creation:</strong> Cmd+click opens links in new tab</p>
          <p><strong>Tab Titles:</strong></p>
          <ul style="margin: 0.5rem 0 0 1rem;">
            <li>DateNodes: "Today", "Yesterday", "Jan 27, 2025"</li>
            <li>TaskNodes: Task title/content (truncated)</li>
            <li>EntityNodes: Entity name + type (e.g., "Acme Corp (Customer)")</li>
          </ul>
        </div>
      </div>
      
      <h3>⚡ Global Transition Control</h3>
      <p>System-wide animation and transition management for consistent user experience preferences.</p>
      
      <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin: 1rem 0;">
        <p style="margin: 0 0 0.5rem 0; font-weight: 500;">Design Philosophy</p>
        <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
          <li><strong>Immediate Feedback:</strong> All interactive states change instantly without animation delays</li>
          <li><strong>Reduced Distraction:</strong> No animated color transitions that can feel "tacky" or draw unnecessary attention</li>
          <li><strong>Performance Focused:</strong> Eliminates animation overhead for faster, more responsive interactions</li>
          <li><strong>Accessibility Friendly:</strong> Respects users who prefer reduced motion without additional configuration</li>
        </ul>
      </div>
      
      <h4>Implementation</h4>
      <div class="example-code">
        <pre><code>/* Global transition disabling in app.css */
*,
*::before,
*::after {
  transition: none !important;
  animation-duration: 0s !important;
  animation-delay: 0s !important;
}</code></pre>
      </div>
      
      <div style="background: hsl(var(--card)); border: 1px solid hsl(var(--border)); padding: 1rem; border-radius: var(--radius); margin: 1rem 0;">
        <p style="margin: 0 0 0.5rem 0; font-weight: 500; color: hsl(var(--warning));">⚠️ Implementation Note</p>
        <p style="margin: 0; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
          This global approach overrides any component-level transitions. For specific cases where animation is needed, 
          consider using CSS classes that explicitly re-enable transitions with higher specificity.
        </p>
      </div>
      
      <h3>@Mention System Pattern</h3>
      <p>Universal node referencing system for creating and linking content across the application with inline editing context.</p>
      
      <div class="pattern-demo">
        <h4 style="margin: 0 0 1rem 0;">Inline Autocomplete Dropdown</h4>
        <div style="border: 1px solid hsl(var(--border)); border-radius: var(--radius); height: 400px; overflow: hidden; background: hsl(var(--background));">
          <div class="node-viewer" style="border: none; border-radius: 0; padding: 1.5rem; background: transparent; height: 100%;">
          <div class="hierarchy-example">
            <!-- Node content with autocomplete trigger -->
            <div class="hierarchy-node">
              <div class="hierarchy-indicator">
                <div class="task-icon">
                  <div class="text-circle"></div>
                </div>
              </div>
              I need to contact @acme<span style="animation: blink 1s infinite;">|</span>
            </div>
          
          <!-- Autocomplete dropdown positioned after @ character -->
          <div style="
            position: absolute;
            top: calc(1.75rem + 0.6rem);
            left: 11.88rem;
            min-width: 300px;
            background: hsl(var(--background));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            z-index: 10;
          ">
            <div style="padding: 0.75rem; border-bottom: 1px solid hsl(var(--border)); cursor: pointer; border-top-left-radius: var(--radius); border-top-right-radius: var(--radius);" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                  <div class="node-icon">
                    <div class="text-circle"></div>
                  </div>
                </div>
                <div style="font-weight: 500;"><span class="search-highlight">Acme</span> Corporation</div>
              </div>
            </div>
            
            <div style="padding: 0.75rem; border-bottom: 1px solid hsl(var(--border)); cursor: pointer;" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                  <div class="node-icon">
                    <div class="text-circle"></div>
                  </div>
                </div>
                <div style="font-weight: 500;"><span class="search-highlight">Acme</span> Corp Campaign Strategy</div>
              </div>
            </div>
            
            <div style="padding: 0.75rem; cursor: pointer; color: hsl(var(--foreground)); background: hsl(var(--muted) / 0.5); font-weight: 600; border-bottom-left-radius: var(--radius); border-bottom-right-radius: var(--radius); text-align: center;" onmouseover="this.style.background='hsl(var(--muted))'; this.style.color='hsl(var(--foreground))';" onmouseout="this.style.background='hsl(var(--muted) / 0.5)'; this.style.color='hsl(var(--foreground))';">
              + Create new "<span class="search-highlight">acme</span>" node
            </div>
          </div>
          </div>
        </div>
      </div>
      
      <!-- Features Description -->
      <div style="margin-top: 1.5rem; padding: 1.5rem; background: hsl(var(--muted)); border-radius: var(--radius);">
        <h4 style="margin: 0 0 1rem 0; color: hsl(var(--foreground));">@Mention System Features</h4>
        <div style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); line-height: 1.6;">
          <p><strong>Inline Autocomplete:</strong> Dropdown positioned precisely after the "@" character</p>
          <p><strong>Seamless Editing:</strong> No input box required, direct text insertion</p>
          <p><strong>Search Highlighting:</strong> Matching text highlighted with proper contrast</p>
          <p><strong>Node Creation:</strong> High-contrast create action for new nodes</p>
          <p><strong>Universal References:</strong> Links any content type across the application</p>
        </div>
      </div>

      <h3>@Mention Positioning Specifications</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">Dropdown Positioning</div>
          <div class="component-demo">
            <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
              <thead>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <th style="padding: 0.5rem; text-align: left;">Direction</th>
                  <th style="padding: 0.5rem; text-align: left;">Position</th>
                  <th style="padding: 0.5rem; text-align: left;">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Horizontal</td>
                  <td style="padding: 0.5rem;"><code>cursor position</code></td>
                  <td style="padding: 0.5rem;">Aligned exactly with '@' character</td>
                </tr>
                <tr style="border-bottom: 1px solid hsl(var(--border));">
                  <td style="padding: 0.5rem;">Vertical</td>
                  <td style="padding: 0.5rem;"><code>cursor position + 0.6rem</code></td>
                  <td style="padding: 0.5rem;">Natural line spacing below text</td>
                </tr>
                <tr>
                  <td style="padding: 0.5rem;">Min Width</td>
                  <td style="padding: 0.5rem;"><code>300px</code></td>
                  <td style="padding: 0.5rem;">Ensures readable content width</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      
      <h3>Slash Commands Pattern</h3>
      <p>Quick commands for creating different node types and templates.</p>
      
      <div class="pattern-demo">
        <h4 style="margin: 0 0 1rem 0;">Command Palette</h4>
        <div style="position: relative; border: 1px solid hsl(var(--border)); border-radius: var(--radius); height: 400px; overflow: hidden; background: hsl(var(--background));">
          <div class="node-viewer" style="border: none; border-radius: 0; padding: 1.5rem; background: transparent; height: 100%;">
          <div class="hierarchy-example">
            <!-- Node content with slash command trigger -->
            <div class="hierarchy-node">
              <div class="hierarchy-indicator">
                <div class="task-icon">
                  <div class="text-circle"></div>
                </div>
              </div>
              /<span style="animation: blink 1s infinite;">|</span>
            </div>
          
          <div style="
            position: absolute;
            top: calc(1.75rem + 0.6rem);
            left: 54px;
            min-width: 300px;
            background: hsl(var(--background));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            z-index: 10;
          ">
            <div style="padding: 0.75rem; border-bottom: 1px solid hsl(var(--border)); cursor: pointer; border-top-left-radius: var(--radius); border-top-right-radius: var(--radius);" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; gap: 0.5rem;">
                <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                  <div class="node-icon">
                    <div class="text-circle"></div>
                  </div>
                </div>
                <div style="font-weight: 500;">Text</div>
              </div>
            </div>
            
            <div style="padding: 0.75rem; border-bottom: 1px solid hsl(var(--border)); cursor: pointer;" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                  <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                    <div class="ai-icon">
                      <div class="h1-square-alt"></div>
                    </div>
                  </div>
                  <div style="font-weight: 500;">Header 1</div>
                </div>
                <code style="background: hsl(var(--muted)); padding: 0.125rem 0.25rem; border-radius: 0.25rem; font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; font-size: 0.75rem;">#</code>
              </div>
            </div>
            
            <div style="padding: 0.75rem; border-bottom: 1px solid hsl(var(--border)); cursor: pointer;" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                  <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                    <div class="ai-icon">
                      <div class="h2-square-alt"></div>
                    </div>
                  </div>
                  <div style="font-weight: 500;">Header 2</div>
                </div>
                <code style="background: hsl(var(--muted)); padding: 0.125rem 0.25rem; border-radius: 0.25rem; font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; font-size: 0.75rem;">##</code>
              </div>
            </div>
            
            <div style="padding: 0.75rem; border-bottom: 1px solid hsl(var(--border)); cursor: pointer;" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                  <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                    <div class="ai-icon">
                      <div class="h3-square-alt"></div>
                    </div>
                  </div>
                  <div style="font-weight: 500;">Header 3</div>
                </div>
                <code style="background: hsl(var(--muted)); padding: 0.125rem 0.25rem; border-radius: 0.25rem; font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; font-size: 0.75rem;">###</code>
              </div>
            </div>
            
            <div style="padding: 0.75rem; border-bottom: 1px solid hsl(var(--border)); cursor: pointer;" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                  <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                    <div class="task-icon">
                      <div class="task-circle task-circle-completed"></div>
                    </div>
                  </div>
                  <div style="font-weight: 500;">Task</div>
                </div>
                <code style="background: hsl(var(--muted)); padding: 0.125rem 0.25rem; border-radius: 0.25rem; font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; font-size: 0.75rem;">[ ]</code>
              </div>
            </div>
            
            <div style="padding: 0.75rem; cursor: pointer; border-bottom-left-radius: var(--radius); border-bottom-right-radius: var(--radius);" onmouseover="this.style.background='hsl(var(--muted))'" onmouseout="this.style.background='transparent'">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                  <div style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
                    <div class="ai-icon">
                      <div class="ai-square-alt"></div>
                    </div>
                  </div>
                  <div style="font-weight: 500;">AI Chat</div>
                </div>
                <code style="background: hsl(var(--muted)); padding: 0.125rem 0.25rem; border-radius: 0.25rem; font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace; font-size: 0.75rem;">⌘ + k</code>
              </div>
            </div>
          </div>
          </div>
        </div>
      </div>

      <h3>Autocomplete System Documentation</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">Dropdown Consistency</div>
          <div class="component-demo">
            <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
              <p style="margin: 0 0 0.5rem 0; font-weight: 500;">Unified Dropdown Specifications</p>
              <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                <li><strong>Width:</strong> <code>min-width: 300px</code> for both @mention and slash command dropdowns</li>
                <li><strong>Item Padding:</strong> <code>0.75rem</code> consistent across all items</li>
                <li><strong>Layout Structure:</strong> <code>display: flex; align-items: center; gap: 0.5rem</code></li>
                <li><strong>Icon Space:</strong> <code>20x20px</code> reserved container (filled for content, empty for actions)</li>
                <li><strong>Typography:</strong> <code>font-weight: 500</code> for content, <code>600</code> for actions</li>
                <li><strong>Positioning:</strong> Precise alignment after trigger characters ("/" and "@")</li>
              </ul>
            </div>
            
            <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius); margin-bottom: 1rem;">
              <p style="margin: 0 0 0.5rem 0; font-weight: 500;">@Mention System</p>
              <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                <li><strong>Content Items:</strong> Circle text node icons for existing nodes</li>
                <li><strong>Create Actions:</strong> Centered text without icons, highlighted background</li>
                <li><strong>Positioning:</strong> <code>left: 11.88rem</code> - precisely after "@" character</li>
                <li><strong>Content:</strong> Clean titles without sub-descriptions</li>
              </ul>
            </div>
            
            <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius);">
              <p style="margin: 0 0 0.5rem 0; font-weight: 500;">Slash Command System</p>
              <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                <li><strong>Text:</strong> Uses <code>node-icon</code> + <code>text-circle</code> (16x16px circle)</li>
                <li><strong>Headers:</strong> Custom <code>h1/h2/h3-square-alt</code> (16x16px squares with punch-holed text)</li>
                <li><strong>Task:</strong> Uses <code>task-icon</code> + <code>task-circle-completed</code> (checkmark)</li>
                <li><strong>AI Chat:</strong> Uses <code>ai-icon</code> + <code>ai-square-alt</code> ("AI" text)</li>
                <li><strong>Positioning:</strong> <code>left: 54px</code> - precisely after "/" character</li>
                <li><strong>Layout:</strong> Icons with labels and keyboard shortcuts</li>
              </ul>
            </div>
          </div>
        </div>
        
        <div class="component-example">
          <div class="component-title">Header Icon Technical Details</div>
          <div class="component-demo">
            <div style="background: hsl(var(--muted)); padding: 1rem; border-radius: var(--radius);">
              <p style="margin: 0 0 0.5rem 0; font-weight: 500;">Custom Header Icon Implementation</p>
              <ul style="margin: 0; padding-left: 1rem; font-size: 0.875rem; color: hsl(var(--muted-foreground));">
                <li><strong>Size:</strong> 16x16px squares with 0.5px border-radius</li>
                <li><strong>Punch-hole Effect:</strong> 14x14px SVG text with background showing through</li>
                <li><strong>Typography:</strong> 16px font-size, 400 weight, system font stack</li>
                <li><strong>Positioning:</strong> Centered at x="10" y="12.5" with dominant-baseline="middle"</li>
                <li><strong>Theme Support:</strong> Light (#FAF9F5) and dark (#252523) text colors</li>
                <li><strong>SVG ViewBox:</strong> 0 0 20 20 for consistent scaling within 14x14px container</li>
                <li><strong>CSS Classes:</strong> <code>.h1-square-alt</code>, <code>.h2-square-alt</code>, <code>.h3-square-alt</code></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>


    <!-- Multi-Pane Layout Pattern -->
    <section class="example-section">
      <h2>Layout Patterns</h2>
      <p>Standard layout configurations for desktop NodeSpace interfaces.</p>
      
      <h3>Two-Panel Layout</h3>
      <div class="layout-demo">
        <div class="main-area">
          <p>Main content area for editing and viewing</p>
        </div>
        <div class="side-panel">
          <h5>Properties</h5>
          <input style="
            width: 100%;
            padding: 0.5rem;
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            background: hsl(var(--background));
            color: hsl(var(--foreground));
          " placeholder="Add tags..." />
          <div>
            <h5 style="margin: 1rem 0 0.5rem 0; font-size: 0.875rem;">Quick Actions</h5>
            <button style="
              width: 100%;
              padding: 0.5rem;
              margin-bottom: 0.5rem;
              border: 1px solid hsl(var(--border));
              background: hsl(var(--background));
              color: hsl(var(--foreground));
              border-radius: var(--radius);
              cursor: pointer;
            ">AI Assist</button>
            <button style="
              width: 100%;
              padding: 0.5rem;
              border: 1px solid hsl(var(--border));
              background: hsl(var(--background));
              color: hsl(var(--foreground));
              border-radius: var(--radius);
              cursor: pointer;
            ">📋 Copy Reference</button>
          </div>
        </div>
      </div>
      <p><strong>Usage:</strong> Primary layout for desktop NodeSpace interfaces. Main area for content editing, side panel for contextual tools and properties.</p>
      
      <h3>Single-Column Layout</h3>
      <div class="pattern-demo">
        <div style="border: 1px solid hsl(var(--border)); border-radius: var(--radius); background: hsl(var(--background));">
          <div class="node-viewer" style="border: none; border-radius: 0; padding: 1.5rem; background: transparent;">
          <div class="hierarchy-example">
            <div class="hierarchy-node">
              <div class="hierarchy-indicator">
                <div class="task-icon">
                  <div class="text-circle"></div>
                </div>
              </div>
              Project Planning Session
            </div>
            <div class="hierarchy-node child-1">
              <div class="hierarchy-indicator">
                <div class="task-icon">
                  <div class="text-circle"></div>
                </div>
              </div>
              Meeting agenda and notes
            </div>
            <div class="hierarchy-node child-2">
              <div class="hierarchy-indicator">
                <div class="task-icon">
                  <div class="task-circle task-circle-pending"></div>
                </div>
              </div>
              Review budget allocations
            </div>
            <div class="hierarchy-node child-2">
              <div class="hierarchy-indicator">
                <div class="task-icon">
                  <div class="task-circle task-circle-pending"></div>
                </div>
              </div>
              Schedule follow-up meetings
            </div>
            <div class="hierarchy-node child-1">
              <div class="hierarchy-indicator">
                <div class="task-icon">
                  <div class="text-circle"></div>
                </div>
              </div>
              AI summary of key decisions
            </div>
          </div>
          </div>
        </div>
        <p><strong>Usage:</strong> Optimal for mobile devices and focused writing sessions. Content takes full width with contextual panels accessed via overlay or drawer.</p>
      </div>
    </section>

    <!-- Interaction Patterns -->
    <section class="example-section">
      <h2>Interaction Patterns</h2>
      <p>Consistent interaction behaviors based on research from leading block-based note-taking tools (Logseq, Notion, Obsidian).</p>
      
      <h3>Keyboard Navigation</h3>
      <div class="keyboard-shortcuts">
        <div class="shortcut-item">
          <span>Navigate up/down</span>
          <span class="kbd">↑ ↓</span>
        </div>
        <div class="shortcut-item">
          <span>Indent node</span>
          <span class="kbd">Tab</span>
        </div>
        <div class="shortcut-item">
          <span>Outdent node</span>
          <span class="kbd">Shift + Tab</span>
        </div>
        <div class="shortcut-item">
          <span>Create new node</span>
          <span class="kbd">Enter</span>
        </div>
        <div class="shortcut-item">
          <span>Line break</span>
          <span class="kbd">Shift + Enter</span>
        </div>
        <div class="shortcut-item">
          <span>Bold text</span>
          <span class="kbd">Cmd + B</span>
        </div>
        <div class="shortcut-item">
          <span>Italic text</span>
          <span class="kbd">Cmd + I</span>
        </div>
        <div class="shortcut-item">
          <span>Trigger autocomplete</span>
          <span class="kbd">@</span>
        </div>
      </div>
      
      <h3>Mouse/Touch Interactions</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">🖱️ Click Behaviors</div>
          <div class="component-demo">
            <ul>
              <li><strong>Single click:</strong> Focus node for editing</li>
              <li><strong>Double click:</strong> Select all content in node</li>
              <li><strong>Drag handle:</strong> Reorder nodes (visible on hover)</li>
              <li><strong>Indicator click:</strong> Toggle node collapse/expand</li>
            </ul>
          </div>
        </div>
        
        <div class="component-example">
          <div class="component-title">👆 Touch Gestures</div>
          <div class="component-demo">
            <ul>
              <li><strong>Tap:</strong> Focus node</li>
              <li><strong>Long press:</strong> Show context menu</li>
              <li><strong>Swipe left:</strong> Show quick actions</li>
              <li><strong>Pinch:</strong> Zoom interface (accessibility)</li>
            </ul>
          </div>
        </div>
      </div>
      
      <h3>Node Editability States</h3>
      <div class="pattern-demo">
        <div style="padding: 1rem; margin: 1rem 0;">
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <div class="node-icon">
              <div class="text-circle"></div>
            </div>
            <span>This node is directly editable (TextNode, TaskNode)</span>
          </div>
        </div>
        <div style="padding: 1rem; margin: 1rem 0; opacity: 0.7;">
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <div class="node-icon">
              <div class="text-circle"></div>
            </div>
            <span>This node is computed from props (PersonNode: "John Doe (john@example.com)")</span>
          </div>
        </div>
        
        <div class="component-showcase">
          <div class="component-example">
            <div class="component-title">Unified Canvas Approach</div>
            <div class="component-demo">
              <ul>
                <li><strong>Directly Editable:</strong> Full opacity, seamless inline editing</li>
                <li><strong>Computed Content:</strong> Reduced opacity (70%), indicates content derives from node properties</li>
                <li><strong>No Node Borders:</strong> Entire nodeviewer functions as unified writing canvas</li>
                <li><strong>Seamless Flow:</strong> Users can edit any directly editable node without visual interruption</li>
              </ul>
            </div>
          </div>
          
          <div class="component-example">
            <div class="component-title">Examples by Node Type</div>
            <div class="component-demo">
              <ul>
                <li><strong>TextNode, TaskNode:</strong> Normal opacity - user can edit content directly</li>
                <li><strong>PersonNode:</strong> Dimmed opacity - content shows "{first} {last} ({email})" from props</li>
                <li><strong>DateNode:</strong> Dimmed opacity - content shows formatted date from timestamp prop</li>
                <li><strong>EntityNode:</strong> Dimmed opacity - content shows computed entity information</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Hierarchical Display -->
    <section class="example-section">
      <h2>Hierarchical Display Patterns</h2>
      <p>Mathematical precision in nested content structures with chevron-based collapse/expand controls, optimized for knowledge management workflows.</p>
      
      <h3>Mathematical Indentation System with Chevron Positioning</h3>
      <div class="pattern-demo">
        <div style="border: 1px solid hsl(var(--border)); border-radius: var(--radius); height: 400px; overflow: hidden; background: hsl(var(--background));">
          <div class="node-viewer" style="border: none; border-radius: 0; padding: 1.5rem; background: transparent; height: 100%;">
          <div class="hierarchy-example">
          <!-- H1 Text Node Parent (Expanded) -->
          <div class="hierarchy-node has-children h1">
            <span class="chevron-icon expanded">
              <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3l5 5-5 5-1-1 4-4-4-4 1-1z"/>
              </svg>
            </span>
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="task-ring"></div>
                <div class="text-circle"></div>
              </div>
            </div>
            Product Launch Campaign Strategy
          </div>
          
          <!-- Child Text Node -->
          <div class="hierarchy-node child-1">
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="text-circle"></div>
              </div>
            </div>
            This comprehensive product launch plan provides the strategic framework...
          </div>
          
          <!-- H2 Text Node Parent (Expanded) -->
          <div class="hierarchy-node has-children h2 child-1">
            <span class="chevron-icon expanded">
              <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3l5 5-5 5-1-1 4-4-4-4 1-1z"/>
              </svg>
            </span>
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="task-ring"></div>
                <div class="text-circle"></div>
              </div>
            </div>
            Launch Overview
          </div>
          
          <!-- Child Text Node -->
          <div class="hierarchy-node child-2">
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="text-circle"></div>
              </div>
            </div>
            <strong>Product:</strong> EcoSmart Professional Series
          </div>
          
          <!-- Completed Task Node -->
          <div class="hierarchy-node child-2">
            <div class="hierarchy-indicator">
              <div class="task-icon">
                <div class="task-circle task-circle-completed"></div>
              </div>
            </div>
            <span style="text-decoration: line-through; opacity: 0.7;">Finalize product launch timeline and key milestones</span>
          </div>
          
          <!-- In Progress Task Node -->
          <div class="hierarchy-node child-2">
            <div class="hierarchy-indicator">
              <div class="task-icon">
                <div class="task-circle task-circle-in-progress"></div>
              </div>
            </div>
            Secure approval for marketing budget allocation
          </div>
          
          <!-- AI Chat Node Parent (Expanded) -->
          <div class="hierarchy-node has-children child-1">
            <span class="chevron-icon expanded">
              <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3l5 5-5 5-1-1 4-4-4-4 1-1z"/>
              </svg>
            </span>
            <div class="hierarchy-indicator">
              <div class="ai-icon">
                <div class="ai-square-ring"></div>
                <div class="ai-square-alt"></div>
              </div>
            </div>
            What should I focus on for this campaign launch?
          </div>
          
          <!-- Child Text Node (AI Response) -->
          <div class="hierarchy-node child-2">
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="text-circle"></div>
              </div>
            </div>
            Based on your budget and timeline, I recommend prioritizing digital channels...
          </div>
          
          <!-- Collapsed parent node for comparison -->
          <div class="hierarchy-node has-children">
            <span class="chevron-icon">
              <svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 3l5 5-5 5-1-1 4-4-4-4 1-1z"/>
              </svg>
            </span>
            <div class="hierarchy-indicator">
              <div class="node-icon">
                <div class="task-ring"></div>
                <div class="text-circle"></div>
              </div>
            </div>
            Collapsed parent (chevron points right, children hidden)
          </div>
            </div>
          </div>
        </div>
        
        <p><strong>Mathematical Chevron Positioning:</strong></p>
        <ul>
          <li><strong>Position Formula:</strong> <code>left: calc(var(--circle-offset) + var(--circle-diameter) / 2 - var(--node-indent) / 2)</code></li>
          <li><strong>Example Calculation:</strong> <code>22px + (20px / 2) - (2.5rem / 2) = 12px</code></li>
          <li><strong>Precision Result:</strong> Chevron positioned exactly halfway between parent and child circles</li>
          <li><strong>Vertical Alignment:</strong> Uses same mathematical formula as circles for perfect alignment</li>
          <li><strong>Color Consistency:</strong> Theme-adaptive warm gray matching node circle indicators</li>
          <li><strong>Animation:</strong> Smooth 90° rotation with transform: <code>translate(-50%, -50%) rotate(90deg)</code></li>
          <li><strong>Interaction:</strong> Click chevron to toggle, Space/Enter keyboard support</li>
          <li><strong>Z-index Layering:</strong> <code>z-index: 3</code> ensures clickable over all content</li>
        </ul>
        
        <div class="example-code">
          <pre><code>/* Perfect Node Alignment System - CSS Variables Architecture */
.node-viewer {
  --circle-offset: 22px;        /* Circle position from left edge - reserves space for chevrons */
  --circle-diameter: 20px;      /* Circle container size */
  --circle-text-gap: 8px;       /* Gap between circle and text */
  --node-indent: 2.5rem;        /* Parent-child indentation */
}

/* Dynamic content padding calculation */
.hierarchy-node {
  padding-left: calc(var(--circle-offset) + var(--circle-diameter) + var(--circle-text-gap));
  /* Result: 22px + 20px + 8px = 50px */
}

/* Child indentation system - consistent 2.5rem like Svelte */
.hierarchy-node.child-1 { margin-left: 2.5rem; /* 40px */ }
.hierarchy-node.child-2 { margin-left: 5rem; /* 80px */ }

/* Mathematical circle positioning */
.hierarchy-indicator {
  position: absolute;
  left: var(--circle-offset);
  top: calc(0.25rem + (var(--line-height-px) / 2));
}

/* Mathematical chevron positioning - corrected formula */
.chevron-icon {
  position: absolute;
  /* This formula correctly calculates the midpoint between parent and child circle centers */
  left: calc(var(--circle-offset) + var(--circle-diameter) / 2 - var(--node-indent) / 2);
  /* Same vertical formula as circles for perfect alignment */
  top: calc(0.25rem + (var(--line-height-px) / 2));
  transform: translate(-50%, -50%); /* Center on coordinates */
  z-index: 3; /* Above all content */
}

/* Formula explanation:
   The goal is to find the midpoint between the parent and child circle centers.
   Parent Circle Center = var(--circle-offset) + (var(--circle-diameter) / 2)
                        = 22px + 10px = 32px
   Child Circle Center  = var(--node-indent) + Parent Circle Center
                        = 40px + 32px = 72px
   Midpoint             = (Parent Circle Center + Child Circle Center) / 2
                        = (32px + 72px) / 2 = 52px (absolute position)
   Chevron Left         = Midpoint - Child Indent
                        = 52px - 40px = 12px (relative to child container)
*/

/* Rotation animation preserves centering */
.chevron-icon.expanded {
  transform: translate(-50%, -50%) rotate(90deg);
}</code></pre>
        </div>
      </div>
      
    </section>

    <!-- Responsive Patterns -->
    <section class="example-section">
      <h2>Responsive Design Patterns</h2>
      <p>Adaptive layouts that maintain usability across all device sizes, from mobile to desktop.</p>
      
      <h3>Breakpoints</h3>
      <div class="responsive-breakpoint">
        <div class="breakpoint-indicator"></div>
        <div>
          <strong>Mobile (< 768px):</strong> Single column, side panels as overlays, increased touch targets (44px minimum)
        </div>
      </div>
      <div class="responsive-breakpoint">
        <div class="breakpoint-indicator"></div>
        <div>
          <strong>Tablet (768px - 1024px):</strong> Adaptive two-column, collapsible side panels, touch-optimized interactions
        </div>
      </div>
      <div class="responsive-breakpoint">
        <div class="breakpoint-indicator"></div>
        <div>
          <strong>Desktop (> 1024px):</strong> Full two-panel layout, hover states, keyboard-optimized workflows
        </div>
      </div>
      
      <h3>Adaptive Behaviors</h3>
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">📱 Mobile Adaptations</div>
          <div class="component-demo">
            <ul>
              <li><strong>Indentation:</strong> Reduced to 16px per level</li>
              <li><strong>Touch targets:</strong> Minimum 44px for comfortable tapping</li>
              <li><strong>Side panels:</strong> Slide-up drawers or full-screen overlays</li>
              <li><strong>Context menus:</strong> Bottom sheet presentation</li>
            </ul>
          </div>
        </div>
        
        <div class="component-example">
          <div class="component-title">🖥️ Desktop Enhancements</div>
          <div class="component-demo">
            <ul>
              <li><strong>Hover states:</strong> Visual feedback for interactive elements</li>
              <li><strong>Right-click menus:</strong> Context-sensitive actions</li>
              <li><strong>Keyboard shortcuts:</strong> Full navigation and editing support</li>
              <li><strong>Multi-panel views:</strong> Simultaneous content and properties</li>
            </ul>
          </div>
        </div>
      </div>
      
      <div class="example-code">
        <pre><code>/* Responsive CSS patterns */
@media (max-width: 768px) {
  .node {
    /* Reduced indentation on mobile */
    --indent-size: 16px;
  }
  
  .side-panel {
    /* Convert to overlay on mobile */
    position: fixed;
    top: 0;
    right: -100%;
    width: 100%;
    height: 100vh;
    z-index: 50;
    transition: right 0.3s ease;
  }
  
  .side-panel.open {
    right: 0;
  }
}

@media (min-width: 1024px) {
  .layout {
    /* Desktop two-panel layout */
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: 1rem;
  }
}</code></pre>
      </div>
    </section>

    <!-- Accessibility Patterns -->
    <section class="example-section">
      <h2>Accessibility Patterns</h2>
      <p>WCAG 2.1 AA compliant patterns that ensure NodeSpace is usable by everyone.</p>
      
      <div class="component-showcase">
        <div class="component-example">
          <div class="component-title">⌨️ Keyboard Navigation</div>
          <div class="component-demo">
            <ul>
              <li><strong>Tab order:</strong> Logical sequence through interactive elements</li>
              <li><strong>Focus indicators:</strong> High contrast 2px outlines</li>
              <li><strong>Escape routes:</strong> ESC key closes modals and returns focus</li>
              <li><strong>Arrow navigation:</strong> Consistent movement through content</li>
            </ul>
          </div>
        </div>
        
        <div class="component-example">
          <div class="component-title">📖 Screen Reader Support</div>
          <div class="component-demo">
            <ul>
              <li><strong>ARIA landmarks:</strong> Clear page structure and navigation</li>
              <li><strong>ARIA labels:</strong> Descriptive text for complex interactions</li>
              <li><strong>Live regions:</strong> Announce dynamic content changes</li>
              <li><strong>Heading hierarchy:</strong> Logical h1-h6 structure</li>
            </ul>
          </div>
        </div>
        
        <div class="component-example">
          <div class="component-title">🎨 Visual Accessibility</div>
          <div class="component-demo">
            <ul>
              <li><strong>Color contrast:</strong> 4.5:1 minimum for normal text</li>
              <li><strong>Color independence:</strong> No information conveyed by color alone</li>
              <li><strong>Focus indicators:</strong> Visible on all interactive elements</li>
              <li><strong>Text scaling:</strong> Readable up to 200% zoom</li>
            </ul>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Footer -->
    <footer style="margin-top: 4rem; padding-top: 2rem; border-top: 1px solid hsl(var(--border)); text-align: center; color: hsl(var(--muted-foreground));">
      <p>NodeSpace Design System - Patterns</p>
    </footer>
  </div>

  <script src="assets/interactive.js"></script>
</body>
</html>